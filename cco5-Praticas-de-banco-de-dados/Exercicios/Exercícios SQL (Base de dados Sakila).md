# CCO5 Práticas de Banco de Dados
![License](https://img.shields.io/badge/Code%20License-MIT-green.svg)
![License](https://img.shields.io/badge/-learning-red.svg)
![License](https://img.shields.io/badge/UNIFG-Práticas%20de%20Banco%20de%20Dados-blue.svg)
# Exercícios SQL (Base de dados Sakila)

## Documentação 
[Banco de dados Sakila](https://www.notion.so/paulofreitaspy/Exerc-cios-SQL-Base-de-dados-Sakila-0180189ba2dc4798abf939fddddbe68d)



1. LISTAR TODOS OS FILMES.
```sql
SELECT * FROM FILM;
```

2. LISTAR FILMES E ATORES QUE ATUARAM NESTES.
```sql
SELECT F.TITLE, A.FIRST_NAME, A.LAST_NAME
FROM FILM F, FILM_ACTOR FA, ACTOR A
WHERE F.FILM_ID = FA.FILM_ID AND A.ACTOR_ID = FA.ACTOR_ID;
```

7. LISTAR O PRIMEIRO E O ÚLTIMO NOME DOS ATORES (ACTOR) ORDENADOS POR ULTIMO NOME E PRIMEIRO NOME
```sql
SELECT LAST_NAME, FIRST_NAME
FROM ACTOR
ORDER BY LAST_NAME ASC, FIRST_NAME ASC;
```


8. LISTAR APENAS O PRIMEIRO E O ULTIMO NOME DOS CLIENTES INATIVOS
```sql
SELECT FIRST_NAME, LAST_NAME
FROM CUSTOMER
WHERE ACTIVE NOT LIKE 1;
```

9. LISTAR O TÍTULO DOS FILMES (FILM) COM DURAÇÃO ENTRE 60 E 80 MINUTOS.
```sql
SELECT TITLE FROM FILM
WHERE LENGTH BETWEEN 60 AND 80;
```

10. LISTAR O TÍTULO DOS FILMES COM PREÇO DE LOCAÇÃO ABAIXO DE 1 DÓLAR, ORDENADOS PELO TÍTULO DE FORMA DECRESCENTE
```sql
SELECT TITLE FROM FILM
WHERE RENTAL_RATE < 1
ORDER BY TITLE DESC;
```

11. LISTAR TÍTULO, PREÇO DE LOCAÇÃO E CUSTO DE SUBSTITUIÇÃO DOS FILMES COM CUSTO DE SUBSTITUIÇÃO ACIMA DE 20 DÓLARES, MAS QUE TENHAM PREÇO DE LOCAÇÃO ABAIXO DE 3 DÓLARES. ORDENAR PELO CUSTO DE SUBSTITUIÇÃO SEGUIDO PELO PREÇO DE LOCAÇÃO
```sql
SELECT TITLE, RENTAL_RATE, REPLACEMENT_COST
FROM FILM
WHERE REPLACEMENT_COST > 20
AND RENTAL_RATE < 3
ORDER BY REPLACEMENT_COST ASC, RENTAL_RATE ASC;
```

12. QUAL A MÉDIA DO PREÇO DE LOCAÇÃO?
```sql
SELECT AVG(RENTAL_RATE) AS MEDIA_PRECO_LOCACAO
FROM FILM;
```

13. QUANTOS FILMES TEM DURAÇÃO DE 120 MINUTOS OU MAIS?
```sql
SELECT TITLE FROM FILM
WHERE LENGTH >= 120;
```

14. QUAL O FILME COM CUSTO DE SUBSTITUIÇÃO MAIS CARO?
```sql
SELECT TITLE, MAX(REPLACEMENT_COST) AS MAIS_CARO
FROM FILM;
```

15. QUAL A MENOR DURAÇÃO DE LOCAÇÃO
```sql
SELECT MIN(F.RENTAL_DURATION) AS MENOR_DURACAO
FROM FILM F;
```

16. LISTAR O TÍTULO DOS FILMES COM PREÇO DE LOCAÇÃO ACIMA DA MÉDIA
```sql
SELECT TITLE, RENTAL_RATE
FROM FILM
WHERE RENTAL_RATE > (SELECT AVG(RENTAL_RATE) FROM FILM);
```

17. LISTAR O TÍTULO DOS FILMES COM MAIOR DURAÇÃO DE LOCAÇÃO
```sql
SELECT TITLE FROM FILM
WHERE LENGTH = (
    SELECT MAX(LENGTH) FROM FILM
);
```

18. LISTAR O TÍTULO DOS FILMES COM MENOR CUSTO DE SUBSTITUIÇÃO
```sql
SELECT TITLE FROM FILM
WHERE REPLACEMENT_COST = (
    SELECT MIN(REPLACEMENT_COST) FROM FILM
);
```

19. QUAIS CIDADES DO BRASIL ESTÃO CADASTRADAS NO SISTEMA?
```sql
SELECT CY.CITY FROM CITY CY, COUNTRY CR
WHERE CY.COUNTRY_ID = CR.COUNTRY_ID
AND CR.COUNTRY = 'BRAZIL';
```

20. LISTAR O NOME DOS CLIENTES, A CIDADE E O PAÍS ONDE MORAM
```sql
SELECT CS.FIRST_NAME, CS.LAST_NAME, CI.CITY, CN.COUNTRY
FROM CUSTOMER CS, COUNTRY CN, CITY CI, ADDRESS A
WHERE CN.COUNTRY_ID = CI.COUNTRY_ID
AND CI.CITY_ID = A.CITY_ID
AND A.ADDRESS_ID = CS.ADDRESS_ID;
```

21. LISTAR O TÍTULO DO FILME E SUA(S) RESPECTIVA(S) CATEGORIA(S)
```sql
SELECT F.TITLE, C.NAME
FROM FILM F, CATEGORY C, FILM_CATEGORY FC
WHERE F.FILM_ID = FC.FILM_ID
AND FC.CATEGORY_ID = C.CATEGORY_ID;
```

22. LISTAR A QUANTIDADE DE FILMES POR CATEGORIA
```sql
SELECT C.NAME, COUNT(*)
FROM FILM F, CATEGORY C, FILM_CATEGORY FC
WHERE F.FILM_ID = FC.FILM_ID
AND FC.CATEGORY_ID = C.CATEGORY_ID
GROUP BY C.NAME;
```

23. LISTAR A QUANTIDADE DE FILMES POR CATEGORIA APENAS DAS CATEGORIAS COM MENOS DE 57 FILMES.
```sql
SELECT C.NAME, COUNT(*) QTD
FROM FILM F, CATEGORY C, FILM_CATEGORY FC
WHERE F.FILM_ID = FC.FILM_ID AND FC.CATEGORY_ID = C.CATEGORY_ID
GROUP BY C.NAME
HAVING QTD < 57;
```

24. LISTAR A DURAÇÃO MÉDIA DOS FILMES POR CATEGORIA APENAS DAS CATEGORIAS COM MENOS DE 57 FILMES.
```sql
SELECT C.NAME, COUNT(*) QTD, AVG(F.LENGTH)
FROM FILM F, CATEGORY C, FILM_CATEGORY FC
WHERE F.FILM_ID = FC.FILM_ID AND FC.CATEGORY_ID = C.CATEGORY_ID
GROUP BY C.NAME
HAVING QTD < 57;
```

25. QUAIS ATORES TRABALHARAM NO FILME 'GOLD RIVER'?
```sql
SELECT ACT.FIRST_NAME, ACT.LAST_NAME
FROM FILM F, FILM_ACTOR FA, ACTOR ACT
WHERE F.FILM_ID = FA.FILM_ID
AND ACT.ACTOR_ID = FA.ACTOR_ID
AND F.TITLE = 'GOLD RIVER';
```

26. QUAIS FILMES A ATRIZ 'MILLA KEITEL' TRABALHOU?
```sql
SELECT F.TITLE, A.FIRST_NAME, A.LAST_NAME
FROM FILM F, FILM_ACTOR FA, ACTOR A
WHERE F.FILM_ID = FA.FILM_ID AND A.ACTOR_ID = FA.ACTOR_ID
AND A.FIRST_NAME = 'MILLA' AND A.LAST_NAME = 'KEITEL';
```

27. LISTAR OS 5 PAÍSES COM O MAIOR NÚMERO DE CLIENTES
```sql
SELECT CN.COUNTRY, COUNT(CS.CUSTOMER_ID) AS QTD
FROM CUSTOMER CS, COUNTRY CN, CITY CY, ADDRESS A
WHERE CS.ADDRESS_ID = A.ADDRESS_ID
AND A.CITY_ID = CY.CITY_ID
AND CY.COUNTRY_ID = CN.COUNTRY_ID
GROUP BY CN.COUNTRY
ORDER BY QTD DESC LIMIT 5;
``

28. LISTAR TODOS OS CLIENTES QUE ALUGARAM FILME DE TERROR
```sql
SELECT CS.FIRST_NAME, CS.LAST_NAME, COUNT(CS.CUSTOMER_ID) AS QTD, CT.NAME
FROM CUSTOMER CS
INNER JOIN RENTAL R ON R.CUSTOMER_ID = CS.CUSTOMER_ID
INNER JOIN INVENTORY I ON R.INVENTORY_ID = I.INVENTORY_ID
INNER JOIN FILM F ON I.FILM_ID = F.FILM_ID
INNER JOIN FILM_CATEGORY FG ON F.FILM_ID = FG.FILM_ID
INNER JOIN CATEGORY CT ON FG.CATEGORY_ID = CT.CATEGORY_ID
WHERE CT.NAME = 'HORROR'
GROUP BY CS.CUSTOMER_ID;
```

29. LISTAR TODOS OS CLIENTES QUE ALUGARAM MAIS DE 3 FILMES DE TERROR
```sql
SELECT CS.FIRST_NAME, CS.LAST_NAME, COUNT(CS.CUSTOMER_ID) AS QTD, CT.NAME
FROM CUSTOMER CS
INNER JOIN RENTAL R ON R.CUSTOMER_ID = CS.CUSTOMER_ID
INNER JOIN INVENTORY I ON R.INVENTORY_ID = I.INVENTORY_ID
INNER JOIN FILM F ON I.FILM_ID = F.FILM_ID
INNER JOIN FILM_CATEGORY FG ON F.FILM_ID = FG.FILM_ID
INNER JOIN CATEGORY CT ON FG.CATEGORY_ID = CT.CATEGORY_ID
WHERE CT.NAME = 'HORROR'
GROUP BY CS.CUSTOMER_ID
HAVING QTD > 3;
```

30. LISTAR O PRIMEIRO E O ULTIMO NOME DOS ATORES E ATRISES COM 'SON' NO ÚLTIMO NOME. ORDENAR PELO PRIMEIRO NOME
```sql
SELECT FIRST_NAME, LAST_NAME
FROM ACTOR
WHERE LAST_NAME LIKE '%SON%'
ORDER BY FIRST_NAME ASC;
```

31. LISTAR OS NOMES COMPLETOS DOS CLIENTES QUE RESIDENTES NO BRASIL. DEVEM SER CONCATENADOS PRIMEIRO E ÚLTIMO NOME
```sql
SELECT CS.FIRST_NAME, CS.LAST_NAME
FROM CUSTOMER CS, COUNTRY CN, CITY CI, ADDRESS A
WHERE CN.COUNTRY_ID = CI.COUNTRY_ID
AND CI.CITY_ID = A.CITY_ID
AND A.ADDRESS_ID = CS.ADDRESS_ID
AND CN.COUNTRY = 'BRAZIL';
```

32. LISTAR CLIENTES ATIVOS E SEUS RESPECTIVOS ENDEREÇOS
```sql
SELECT FIRST_NAME, LAST_NAME, ADDRESS
FROM CUSTOMER C, ADDRESS A
WHERE ACTIVE = 1 AND C.ADDRESS_ID = A.ADDRESS_ID;
```

33. LISTAR A QUANRIDADE DE FILMES ALUGADOS POR  CLIENTE EM ORDEM DECRESCENTE DE QUANTIDADE DE FILMES ALUGADOS.
```sql
SELECT C.FIRST_NAME, C.LAST_NAME, COUNT(*) QTD
FROM CUSTOMER C, RENTAL R
WHERE C.CUSTOMER_ID = R.CUSTOMER_ID
GROUP BY (C.CUSTOMER_ID)
ORDER BY QTD DESC;
```

34. LISTAR NOME DOS CLIENTES QUE POSSUEM FILME ALUGADO NO MOMENTO.
```sql
SELECT C.FIRST_NAME, C.LAST_NAME
FROM CUSTOMER C
WHERE EXISTS
        (SELECT 1
        FROM RENTAL R
        WHERE C.CUSTOMER_ID = R.CUSTOMER_ID AND R.RETURN_DATE IS NOT NULL);
```
 
35. LISTAR NOME DOS CLIENTES QUE NÃO POSSUEM FILME ALUGADO NO MOMENTO.
```sql
SELECT C.FIRST_NAME, C.LAST_NAME
FROM CUSTOMER C
WHERE NOT EXISTS
        (SELECT 1
        FROM RENTAL R
        WHERE C.CUSTOMER_ID = R.CUSTOMER_ID AND R.RETURN_DATE IS NOT NULL);
```
